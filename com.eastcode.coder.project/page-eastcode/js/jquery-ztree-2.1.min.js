/*
 * JQuery zTree 2.1
 * http://code.google.com/p/jquerytree/
 *
 * Copyright (c) 2010 Hunter.z
 *
 * Date: 2010-10-12
 *
 */

(function(f){function Ga(a,b){b.unbind(U);b.bind(U,function(c,e,d){typeof a.callback.click=="function"&&a.callback.click(c,e,d)});b.unbind(V);b.bind(V,function(c,e,d){typeof a.callback.change=="function"&&a.callback.change(c,e,d)});b.unbind(W);b.bind(W,function(c,e,d){typeof a.callback.rename=="function"&&a.callback.rename(c,e,d)});b.unbind(X);b.bind(X,function(c,e,d){typeof a.callback.remove=="function"&&a.callback.remove(c,e,d)});b.unbind(Y);b.bind(Y,function(c,e,d){typeof a.callback.drag=="function"&&
a.callback.drag(c,e,d)});b.unbind(M);b.bind(M,function(c,e,d,g){typeof a.callback.drop=="function"&&a.callback.drop(c,e,d,g)});b.unbind(Z);b.bind(Z,function(c,e,d){typeof a.callback.expand=="function"&&a.callback.expand(c,e,d)});b.unbind($);b.bind($,function(c,e,d){typeof a.callback.collapse=="function"&&a.callback.collapse(c,e,d)});b.unbind(aa);b.bind(aa,function(c,e,d,g){typeof a.callback.asyncSuccess=="function"&&a.callback.asyncSuccess(c,e,d,g)});b.unbind(ba);b.bind(ba,function(c,e,d,g,p,q){typeof a.callback.asyncError==
"function"&&a.callback.asyncError(c,e,d,g,p,q)})}function H(a,b,c,e){if(c)for(var d=0;d<c.length;d++){var g=c[d];g.level=b;g.tId=a.treeObjId+"_"+ ++ca;g.parentNode=e;g.checkedNew=g.checkedNew==undefined?g.checked==true:g.checkedNew;g.check_Focus=false;g.check_True_Full=true;g.check_False_Full=true;g.editNameStatus=false;g.isFirstNode=(e?e:a.root)[a.nodesCol].length==c.length&&d==0;g.isLastNode=d==c.length-1;if(g[a.nodesCol]&&g[a.nodesCol].length>0){g.open=g.open?true:false;g.isParent=true;ma(a,g);
H(a,b+1,g[a.nodesCol],g)}else{g.isParent=g.isParent?true:false;ma(a,g);a.checkable&&d==c.length-1&&N(a,g)}}}function ma(a,b){var c=b.parentNode;c=c?f("#"+b.parentNode.tId+s):f("#"+a.treeObjId);c.append("<li id='"+b.tId+"' class='tree-node'><button type=\"button\" class=\"switch\" id='"+b.tId+r+"' title='' onfocus='this.blur();'></button><a id='"+b.tId+u+"' onclick=\""+(b.click||"")+'" ><button type="button" class="'+(b.iconSkin?b.iconSkin:"")+" ico\" id='"+b.tId+t+"' title='' onfocus='this.blur();'></button><span id='"+
b.tId+B+"'></span></a><ul id='"+b.tId+s+"'></ul></li>");c=f("#"+b.tId+r);var e=f("#"+b.tId+u),d=f("#"+b.tId+B),g=f("#"+b.tId+s);d.text(b[a.nameCol]);d=f("#"+b.tId+t);if(a.showLine){if(b.level==0&&b.isFirstNode&&b.isLastNode)c.attr("class",c.attr("class")+"_"+O);else if(b.level==0&&b.isFirstNode)c.attr("class",c.attr("class")+"_"+C);else b.isLastNode?c.attr("class",c.attr("class")+"_"+y):c.attr("class",c.attr("class")+"_"+P);b.isLastNode||g.addClass(D)}else c.attr("class",c.attr("class")+"_"+na);if(b.isParent){var p=
b.open?"_"+z:"_"+A;c.attr("class",c.attr("class")+p);d.attr("class",d.attr("class")+p)}else{c.attr("class",c.attr("class")+"_"+w);d.attr("class",d.attr("class")+"_"+w)}b.icon&&d.attr("style","background:url("+b.icon+") 0 0 no-repeat;");g.css({display:b.open?"block":"none"});if(b.isParent){c.bind("click",{treeObjId:a.treeObjId,treeNode:b},Q);e.bind("dblclick",{treeObjId:a.treeObjId,treeNode:b},Q)}e.bind("click",function(){var k=true;if(typeof a.callback.beforeClick=="function")k=a.callback.beforeClick(a.treeObjId,
b);if(k!=false){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty();R(a,b);f("#"+a.treeObjId).trigger(U,[a.treeObjId,b])}});d.bind("mousedown",function(){b.editNameStatus=false});if(a.checkable){c.after("<BUTTON type='BUTTON' ID='"+b.tId+"_check' onfocus='this.blur();' ></BUTTON>");var q=f("#"+b.tId+"_check");if(a.checkStyle==E&&a.checkRadioType==da&&b.checkedNew)a.checkRadioCheckedList=a.checkRadioCheckedList.concat([b]);v(a,q,b);q.bind("click",function(){var k=
true;if(typeof a.callback.beforeChange=="function")k=a.callback.beforeChange(a.treeObjId,b);if(k!=false){b.checkedNew=!b.checkedNew;if(a.checkStyle==E)if(b.checkedNew)if(a.checkRadioType==da){for(var h=a.checkRadioCheckedList.length-1;h>=0;h--){k=a.checkRadioCheckedList[h];k.checkedNew=false;a.checkRadioCheckedList.splice(h,1);v(a,f("#"+k.tId+"_check"),k);k.parentNode!=b.parentNode&&oa(a,k)}a.checkRadioCheckedList=a.checkRadioCheckedList.concat([b])}else{h=b.parentNode?b.parentNode:a.root;for(var j=
0;j<h[a.nodesCol].length;j++){k=h[a.nodesCol][j];if(k.checkedNew&&k!=b){k.checkedNew=false;v(a,f("#"+k.tId+"_check"),k)}}}else{if(a.checkRadioType==da)for(h=0;h<a.checkRadioCheckedList.length;h++)if(b==a.checkRadioCheckedList[h]){a.checkRadioCheckedList.splice(h,1);break}}else{if(b.checkedNew&&a.checkType.Y.indexOf("s")>-1){ea(a,b,true);fa(a,b)}b.checkedNew&&a.checkType.Y.indexOf("p")>-1&&ga(a,b,true);if(!b.checkedNew&&a.checkType.N.indexOf("s")>-1){ea(a,b,false);fa(a,b)}!b.checkedNew&&a.checkType.N.indexOf("p")>
-1&&ga(a,b,false)}v(a,q,b);oa(a,b);f("#"+a.treeObjId).trigger(V,[a.treeObjId,b])}});q.bind("mouseover",function(){b.checkboxFocus=true;v(a,q,b)});q.bind("mouseout",function(){b.checkboxFocus=false;v(a,q,b)})}e.attr("target",b.target||"_blank");b.url&&!a.editable&&e.attr("href",b.url);a.editable&&e.hover(function(){if(a.dragStatus==0){I(b);J(b);pa(a,b);qa(a,b)}},function(){I(b);J(b)});e.bind("mousedown",function(k){if(!(k.button==2||!a.editable)){var h=document,j,m,Ha=k.clientX,Ia=k.clientY;f(h).mousemove(function(o){if(b.editNameStatus)return true;
window.getSelection?window.getSelection().removeAllRanges():document.selection.empty();if(a.dragStatus==0&&Math.abs(Ha-o.clientX)<ra&&Math.abs(Ia-o.clientY)<ra)return true;f("body").css("cursor","pointer");f("#"+b.tId+r);if(a.dragStatus==0&&b.isParent&&b.open){x(a,b,!b.open);a.dragNodeShowBefore=true}if(a.dragStatus==0){a.dragStatus=-1;var l=true;if(typeof a.callback.beforeDrag=="function")l=a.callback.beforeDrag(a.treeObjId,b);if(l==false)return;a.dragStatus=1;sa(true);R(a,b);I(b);J(b);l=f("#"+b.tId).clone();
l.attr("id",b.tId+"_tmp");l.css("padding","0");l.children("#"+b.tId+u).removeClass(ha);l.children("#"+b.tId+s).css("display","none");j=f("<ul class='zTreeDragUL'></ul>").append(l);j.attr("id",b.tId+s+"_tmp");j.addClass(f("#"+a.treeObjId).attr("class"));j.appendTo("body");f("#"+a.treeObjId).trigger(Y,[a.treeObjId,b])}if(a.dragStatus==1){if(m){m.removeClass(ia);m.removeClass(S)}m=null;if(o.target.id==a.treeObjId&&b.parentNode!=null){m=f("#"+a.treeObjId);m.addClass(ia)}else if(o.target.id&&f("#"+a.treeObjId).find("#"+
o.target.id).length>0){for(l=f("#"+o.target.id);!l.is("li")&&l.attr("id")!=a.treeObjId;)l=l.parent();if(b.parentNode&&l.attr("id")!=b.tId&&l.attr("id")!=b.parentNode.tId&&f("#"+b.tId).find("#"+l.attr("id")).length==0){l.children("a").addClass(S);m=l.children("a")}else if(b.parentNode==null&&l.attr("id")!=b.tId&&f("#"+b.tId).find("#"+l.attr("id")).length==0){l.children("a").addClass(S);m=l.children("a")}}j.css({top:o.clientY+(h.body.scrollTop==0?h.documentElement.scrollTop:h.body.scrollTop)+3+"px",
left:o.clientX+(h.body.scrollLeft==0?h.documentElement.scrollLeft:h.body.scrollLeft)+3+"px"})}return false});f(h).mouseup(function(){f(h).unbind("mousemove");f(h).unbind("mouseup");f("body").css("cursor","auto");if(m){m.removeClass(ia);m.removeClass(S)}sa(false);if(a.dragStatus!=0){a.dragStatus=0;if(b.isParent&&a.dragNodeShowBefore&&!b.open){x(a,b,!b.open);a.dragNodeShowBefore=false}j&&j.remove();if(m){var o="";if(m.attr("id")==a.treeObjId)o=null;else{for(m=m.parent();!m.is("li")&&m.attr("id")!=a.treeObjId;)m=
m.parent();o=m.attr("id")}o=o==null?null:ja(a,a.root[a.nodesCol],o);var l=true;if(typeof a.callback.beforeDrop=="function")l=a.callback.beforeDrop(a.treeObjId,b,o);if(l!=false){ta(a,o,b);f("#"+a.treeObjId).trigger(M,[a.treeObjId,b,o])}}else f("#"+a.treeObjId).trigger(M,[a.treeObjId,null,null])}})}})}function Ja(a,b){if(a.setSelectionRange){a.focus();a.setSelectionRange(b,b)}else if(a.createTextRange){var c=a.createTextRange();c.collapse(true);c.moveEnd("character",b);c.moveStart("character",b);c.select()}}
function sa(a){for(;T.length>0;){T[0].remove();T.shift()}if(a){a=f("iframe");for(var b=0;b<a.length;b++){var c=a.get(b),e;e=Array(2);oRect=c.getBoundingClientRect();e[0]=oRect.left;e[1]=oRect.top;e=e;c=f("<div id='zTreeMask_"+b+"' class='zTreeMask' style='top:"+e[1]+"px; left:"+e[0]+"px; width:"+c.offsetWidth+"px; height:"+c.offsetHeight+"px;'></div>");c.appendTo("body");T.push(c)}}}function n(a,b){if(a){var c=a.attr("class");if(c!=undefined){c=c.split("_");switch(b){case O:case C:case P:case y:case na:c[1]=
b;break;case z:case A:case w:c[2]=b}a.attr("class",c.join("_"))}}}function F(a,b){if(a){var c=a.attr("class");if(c!=undefined){c=c.split("_");switch(b){case z:case A:case w:c[1]=b}a.attr("class",c.join("_"))}}}function I(a){f("#"+a.tId+K).unbind().remove()}function J(a){f("#"+a.tId+G).unbind().remove()}function pa(a,b){if(!(!a.edit_renameBtn||b.editNameStatus||f("#"+b.tId+K).length>0)){var c=f("#"+b.tId+u),e="<button type='button' class='edit' id='"+b.tId+K+"' title='' onfocus='this.blur();' style='display:none;'></button>";
c.append(e);var d=f("#"+b.tId+K);if(a.treeObj.attr("offsetLeft")+a.treeObj.attr("offsetWidth")+a.treeObj.attr("scrollLeft")-c.attr("offsetLeft")-c.attr("offsetWidth")-2*d.width()-15<0){d.remove();c.prepend(e);d=f("#"+b.tId+K)}d.bind("click",function(){var g=true;if(typeof a.callback.beforeRename=="function")g=a.callback.beforeRename(a.treeObjId,b);if(g!=false){I(b);J(b);b.editNameStatus=true;R(a,b);return false}}).bind("mousedown",function(){return true}).show()}}function qa(a,b){if(!(!a.edit_removeBtn||
f("#"+b.tId+G).length>0)){var c=f("#"+b.tId+u),e="<button type='button' class='remove' id='"+b.tId+G+"' title='' onfocus='this.blur();' style='display:none;'></button>";c.append(e);var d=f("#"+b.tId+G);if(a.treeObj.attr("offsetLeft")+a.treeObj.attr("offsetWidth")-c.attr("offsetLeft")-c.attr("offsetWidth")-1*d.width()-15<0){d.remove();c.prepend(e);d=f("#"+b.tId+G)}f("#"+b.tId+G).bind("click",function(){var g=true;if(typeof a.callback.beforeRemove=="function")g=a.callback.beforeRemove(a.treeObjId,b);
if(g!=false){ua(a,b);f("#"+a.treeObjId).trigger(X,[a.treeObjId,b]);return false}}).bind("mousedown",function(){return true}).show()}}function v(a,b,c){if(b){b.removeClass();a=a.checkStyle+"_"+(c.checkedNew?Ka:La)+"_"+(c.checkedNew||a.checkStyle==E?c.check_True_Full?va:wa:c.check_False_Full?va:wa);a=c.checkboxFocus?a+"_"+Ma:a;b.addClass(Na);b.addClass(a)}}function N(a,b){if(b&&b.parentNode){xa(a,b.parentNode);N(a,b.parentNode)}}function oa(a,b){b[a.nodesCol]&&b[a.nodesCol].length>0?N(a,b[a.nodesCol][0]):
N(a,b)}function fa(a,b){if(b&&b[a.nodesCol]){for(var c=0;c<b[a.nodesCol].length;c++)b[a.nodesCol][c][a.nodesCol]&&fa(a,b[a.nodesCol][c]);xa(a,b)}}function xa(a,b){if(b&&b[a.nodesCol]){for(var c=true,e=true,d=0;d<b[a.nodesCol].length;d++){if(a.checkStyle==E&&(b[a.nodesCol][d].checkedNew||!b[a.nodesCol][d].check_True_Full))c=false;else if(a.checkStyle!=E&&b.checkedNew&&(!b[a.nodesCol][d].checkedNew||!b[a.nodesCol][d].check_True_Full))c=false;else if(a.checkStyle!=E&&!b.checkedNew&&(b[a.nodesCol][d].checkedNew||
!b[a.nodesCol][d].check_False_Full))e=false;if(!c||!e)break}b.check_True_Full=c;b.check_False_Full=e;c=f("#"+b.tId+"_check");v(a,c,b)}}function Q(a){var b=i[a.data.treeObjId];a=a.data.treeNode;b.expandTriggerFlag=true;if(a.open){var c=true;if(typeof b.callback.beforeCollapse=="function")c=b.callback.beforeCollapse(b.treeObjId,a);if(c==false){b.expandTriggerFlag=false;return}}else{c=true;if(typeof b.callback.beforeExpand=="function")c=b.callback.beforeExpand(b.treeObjId,a);if(c==false){b.expandTriggerFlag=
false;return}}ya(b,a)}function ya(a,b){if(b&&b[a.nodesCol]&&b[a.nodesCol].length>0)x(a,b,!b.open);else a.async&&!a.editable&&za(a,b)}function za(a,b){for(var c="",e=0;b&&e<a.asyncParam.length;e++)c+=(c.length>0?"&":"")+a.asyncParam[e]+"="+b[a.asyncParam[e]];for(e=0;e<a.asyncParamOther.length;e+=2)c+=(c.length>0?"&":"")+a.asyncParamOther[e]+"="+a.asyncParamOther[e+1];f.ajax({type:"POST",url:a.asyncUrl,data:c,success:function(d){if(!(!d||d.length==0)){var g="";try{g=eval("("+d+")")}catch(p){}g&&g!=
""&&Aa(a,b,g,false);f("#"+a.treeObjId).trigger(aa,[a.treeObjId,b,d])}},error:function(d,g,p){a.expandTriggerFlag=false;f("#"+a.treeObjId).trigger(ba,[a.treeObjId,b,d,g,p])}})}function x(a,b,c,e,d){if(!b||b.open==c)typeof d=="function"&&d();else{if(a.expandTriggerFlag){d=function(){b.open?f("#"+a.treeObjId).trigger(Z,[a.treeObjId,b]):f("#"+a.treeObjId).trigger($,[a.treeObjId,b])};a.expandTriggerFlag=false}c=f("#"+b.tId+r);var g=f("#"+b.tId+t),p=f("#"+b.tId+s);if(b.isParent&&b[a.nodesCol]&&b[a.nodesCol].length>
0)if(b.open){n(c,A);F(g,A);b.open=false;if(e==false){p.hide();typeof d=="function"&&d()}else p.hide(a.expandSpeed,d)}else{n(c,z);F(g,z);b.open=true;if(e==false){p.show();typeof d=="function"&&d()}else p.show(a.expandSpeed,d)}}}function ka(a,b,c,e,d){var g=b?b[a.nodesCol]:a.root[a.nodesCol],p=b?false:e;if(g)for(var q=0;q<g.length;q++)g[q]&&ka(a,g[q],c,p);x(a,b,c,e,d)}function L(a,b,c,e,d){if(b.parentNode){x(a,b,c,e);b.parentNode&&L(a,b.parentNode,c,e,d)}else x(a,b,c,e,d)}function ga(a,b,c){var e=f("#"+
b.tId+"_check");b.checkedNew=c;v(a,e,b);if(b.parentNode){e=true;if(!c)for(var d=0;d<b.parentNode[a.nodesCol].length;d++)if(b.parentNode[a.nodesCol][d].checkedNew){e=false;break}e&&ga(a,b.parentNode,c)}}function ea(a,b,c){if(b){var e=f("#"+b.tId+"_check");b.checkedNew=c;v(a,e,b);if(b[a.nodesCol])for(e=0;e<b[a.nodesCol].length;e++)b[a.nodesCol][e]&&ea(a,b[a.nodesCol][e],c)}}function Ba(a,b,c){if(c){c.level=b?b.level+1:0;if(c[a.nodesCol])for(b=0;b<c[a.nodesCol].length;b++)c[a.nodesCol][b]&&Ba(a,c,c[a.nodesCol][b])}}
function Aa(a,b,c,e){if(b){if(f("#"+a.treeObjId).find("#"+b.tId).length!=0){target_switchObj=f("#"+b.tId+r);target_icoObj=f("#"+b.tId+t);target_aObj=f("#"+b.tId+u);target_ulObj=f("#"+b.tId+s);if(!b.open){n(target_switchObj,A);F(target_icoObj,A);b.open=false;target_ulObj.css({display:"none"})}if(!b.isParent){target_switchObj.unbind("click");target_switchObj.bind("click",function(){x(a,b,!b.open)});target_aObj.unbind("dblclick");target_aObj.bind("dblclick",{treeObjId:a.treeObjId,treeNode:b},Q)}Ca(a,
b,c);H(a,b.level+1,c,b);e||L(a,b,true)}}else{Ca(a,a.root,c);H(a,0,c,null)}}function Ca(a,b,c){b[a.nodesCol]||(b[a.nodesCol]=[]);if(b[a.nodesCol].length>0){var e=b[a.nodesCol][b[a.nodesCol].length-1].tId;b[a.nodesCol][b[a.nodesCol].length-1].isLastNode=false;b[a.nodesCol][b[a.nodesCol].length-1].isFirstNode?n(f("#"+e+r),C):n(f("#"+e+r),P);f("#"+e+s).addClass(D)}b.isParent=true;b[a.nodesCol]=b[a.nodesCol].concat(c)}function ta(a,b,c,e){if(b!=c){var d=c.parentNode==null?a.root:c.parentNode,g=b===null||
b==a.root;if(g&&b===null)b=a.root;var p=f("#"+c.tId+r),q=f("#"+c.tId+s),k,h,j,m;if(g)k=k=f("#"+a.treeObjId);else{h=f("#"+b.tId+r);j=f("#"+b.tId+t);m=f("#"+b.tId+u);k=f("#"+b.tId+s)}n(h,z);F(j,z);b.open=true;k.css({display:"block"});if(!b.isParent&&!g){h.unbind("click");h.bind("click",function(){x(a,b,!b.open)});m.unbind("dblclick");m.bind("dblclick",{treeObjId:a.treeObjId,treeNode:b},Q)}k.append(f("#"+c.tId).detach());h=-1;for(j=0;j<d[a.nodesCol].length;j++)if(d[a.nodesCol][j].tId==c.tId)h=j;h>=0&&
d[a.nodesCol].splice(h,1);if(b[a.nodesCol]){if(a.showLine&&b[a.nodesCol].length>0){b[a.nodesCol][b[a.nodesCol].length-1].isLastNode=false;h=f("#"+b[a.nodesCol][b[a.nodesCol].length-1].tId+s);j=f("#"+b[a.nodesCol][b[a.nodesCol].length-1].tId+r);h.addClass(D);g&&b[a.nodesCol][b[a.nodesCol].length-1].isFirstNode?n(j,C):n(j,P)}}else b[a.nodesCol]=[];if(g)c.parentNode=null;else{b.isParent=true;c.parentNode=b}Ba(a,c.parentNode,c);b[a.nodesCol].splice(b[a.nodesCol].length,0,c);c.isLastNode=true;c.isFirstNode=
b[a.nodesCol].length==1;if(a.showLine){n(p,y);q.removeClass(D)}if(d[a.nodesCol].length<1){d.isParent=false;h=f("#"+d.tId+s);j=f("#"+d.tId+r);c=f("#"+d.tId+t);n(j,w);F(c,w);h.css("display","none")}else if(a.showLine){d[a.nodesCol][d[a.nodesCol].length-1].isLastNode=true;d[a.nodesCol][d[a.nodesCol].length-1].isFirstNode=d[a.nodesCol].length==1;h=f("#"+d[a.nodesCol][d[a.nodesCol].length-1].tId+s);j=f("#"+d[a.nodesCol][d[a.nodesCol].length-1].tId+r);c=f("#"+d[a.nodesCol][d[a.nodesCol].length-1].tId+t);
if(d==a.root)if(d[a.nodesCol].length==1)n(j,O);else{d=f("#"+d[a.nodesCol][0].tId+r);n(d,C);n(j,y)}else n(j,y);h.removeClass(D)}L(a,b,true,e)}}function ua(a,b){var c=b.parentNode==null?a.root:b.parentNode;if(a.curTreeNode===b)a.curTreeNode=null;if(a.curEditTreeNode===b)a.curEditTreeNode=null;f("#"+b.tId).remove();for(var e=-1,d=0;d<c[a.nodesCol].length;d++)if(c[a.nodesCol][d].tId==b.tId)e=d;e>=0&&c[a.nodesCol].splice(e,1);if(c[a.nodesCol].length<1){c.isParent=false;e=f("#"+c.tId+s);d=f("#"+c.tId+r);
c=f("#"+c.tId+t);n(d,w);F(c,w);e.css("display","none")}else if(a.showLine){c[a.nodesCol][c[a.nodesCol].length-1].isLastNode=true;c[a.nodesCol][c[a.nodesCol].length-1].isFirstNode=c[a.nodesCol].length==1;e=f("#"+c[a.nodesCol][c[a.nodesCol].length-1].tId+s);d=f("#"+c[a.nodesCol][c[a.nodesCol].length-1].tId+r);f("#"+c[a.nodesCol][c[a.nodesCol].length-1].tId+t);if(c==a.root)if(c[a.nodesCol].length==1)n(d,O);else{c=f("#"+c[a.nodesCol][0].tId+r);n(c,C);n(d,y)}else n(d,y);e.removeClass(D)}}function ja(a,
b,c){if(!b||!c)return null;for(var e=0;e<b.length;e++){if(b[e].tId==c)return b[e];var d=ja(a,b[e][a.nodesCol],c);if(d)return d}return null}function Da(a){if(a.curTreeNode){I(a.curTreeNode);J(a.curTreeNode);f("#"+a.curTreeNode.tId+u).removeClass(ha);f("#"+a.curTreeNode.tId+B).text(a.curTreeNode[a.nameCol]);a.curTreeNode=null}}function Oa(a){if(a.curEditTreeNode){f("#"+a.curEditTreeNode.tId+u).removeClass(Ea);f("#"+a.curEditTreeNode.tId+la).unbind();f("#"+a.curEditTreeNode.tId+B).text(a.curEditTreeNode[a.nameCol]);
a.curEditTreeNode.editNameStatus=false;a.curEditTreeNode=null}}function R(a,b){if(!(a.curTreeNode==b&&!a.editable)){Da(a);Oa(a);if(a.editable){pa(a,b);qa(a,b)}if(b.editNameStatus){f("#"+b.tId+B).html("<input type=text class='rename' id='"+b.tId+la+"'>");var c=f("#"+b.tId+la);c.attr("value",b[a.nameCol]);c.focus();Ja(c.get(0),b[a.nameCol].length);c.bind("blur",function(){b[a.nameCol]=this.value;f("#"+a.treeObjId).trigger(W,[a.treeObjId,b])}).bind("click",function(){return false}).bind("dblclick",function(){return false});
f("#"+b.tId+u).addClass(Ea);a.curEditTreeNode=b}else f("#"+b.tId+u).addClass(ha);a.curTreeNode=b}}function Fa(a,b,c){if(!b)return[];for(var e=[],d=0;d<b.length;d++){if(b[d].checkedNew==c)e=e.concat([b[d]]);var g=Fa(a,b[d][a.nodesCol],c);if(g.length>0)e=e.concat(g)}return e}function Pa(){return{container:null,init:function(a){this.container=a;return this},refresh:function(){var a=this.container.attr("id");f("#"+a).empty();i[a].curTreeNode=null;i[a].curEditTreeNode=null;i[a].dragStatus=0;i[a].dragNodeShowBefore=
false;i[a].checkRadioCheckedList=[];ca=0;H(i[a],0,i[a].root[i[a].nodesCol])},setEditable:function(a){var b=this.container.attr("id");i[b].editable=a;return this.refresh()},getNodes:function(){var a=this.container.attr("id");return i[a].root[i[a].nodesCol]},getSelectedNode:function(){var a=this.container.attr("id");return i[a].curTreeNode},getCheckedNodes:function(a){var b=this.container.attr("id");if(b){a=a!=false;return Fa(i[b],i[b].root[i[b].nodesCol],a)}},getNodeByTId:function(a){var b=this.container.attr("id");
if(b&&a)return ja(i[b],i[b].root[i[b].nodesCol],a)},getNodeIndex:function(a){var b=this.container.attr("id");if(b&&a){for(var c=a.parentNode==null?i[b].root:a.parentNode,e=0;e<c[i[b].nodesCol].length;e++)if(c[i[b].nodesCol][e]==a)return e;return-1}},getSetting:function(){var a=this.container.attr("id");if(a){a=i[a];var b={checkType:{},callback:{}},c=a.checkType;a.checkType=undefined;var e=a.callback;a.callback=undefined;var d=a.root;a.root=undefined;f.extend(b,a);a.checkType=c;a.callback=e;a.root=
d;f.extend(true,b.checkType,c);f.extend(b.callback,e);return b}},updateSetting:function(a){var b=this.container.attr("id");if(b&&a){var c=i[b],e=a.checkType;a.checkType=undefined;var d=a.callback;a.callback=undefined;var g=a.root;a.root=undefined;f.extend(c,a);a.checkType=e;a.callback=d;a.root=g;f.extend(true,c.checkType,e);f.extend(c.callback,d);c.treeObjId=b}},expandAll:function(a){var b=this.container.attr("id");ka(i[b],null,a,true)},expandNode:function(a,b,c){var e=this.container.attr("id");if(e&&
a){b&&L(i[e],a,b,false);if(c)ka(i[e],a,b,false,function(){f("#"+a.tId+t).focus().blur()});else if(a.open!=b){ya(i[e],a);f("#"+a.tId+t).focus().blur()}}},selectNode:function(a){var b=this.container.attr("id");if(b&&a){R(i[b],a);L(i[b],a,true,false,function(){f("#"+a.tId+t).focus().blur()})}},cancleSelectedNode:function(){var a=this.container.attr("id");a&&Da(i[a])},addNodes:function(a,b,c){var e=this.container.attr("id");if(e&&b){a||(a=null);Aa(i[e],a,b,c==true)}},updateNode:function(a){var b=this.container.attr("id");
b&&a&&f("#"+a.tId+B).text(a[i[b].nameCol])},moveNode:function(a,b){var c=this.container.attr("id");if(c&&b)if(!(a&&(b.parentNode==a||f("#"+b.tId).find("#"+a.tId).length>0))){a||(a=null);ta(i[c],a,b,false)}},removeNode:function(a){var b=this.container.attr("id");b&&a&&ua(i[b],a)}}}var U="ZTREE_CLICK",V="ZTREE_CHANGE",W="ZTREE_RENAME",X="ZTREE_REMOVE",Y="ZTREE_DRAG",M="ZTREE_DROP",Z="ZTREE_EXPAND",$="ZTREE_COLLAPSE",aa="ZTREE_ASYNC_SUCCESS",ba="ZTREE_ASYNC_ERROR",r="_switch",t="_ico",B="_span",la="_input",
K="_edit",G="_remove",s="_ul",u="_a",O="root",C="roots",P="center",y="bottom",na="noLine",D="line",z="open",A="close",w="docu",ha="curSelectedNode",Ea="curSelectedNode_Edit",ia="tmpTargetTree",S="tmpTargetNode",E="radio",Na="chk",La="false",Ka="true",va="full",wa="part",Ma="focus",da="all",ra="5",i=[],ca=0;f.fn.zTree=function(a,b){var c={treeObjId:"",checkable:false,editable:false,edit_renameBtn:true,edit_removeBtn:true,showLine:true,curTreeNode:null,curEditTreeNode:null,dragStatus:0,dragNodeShowBefore:false,
checkStyle:"checkbox",checkType:{Y:"ps",N:"ps"},checkRadioType:"level",checkRadioCheckedList:[],async:false,asyncUrl:"",asyncParam:[],asyncParamOther:[],nameCol:"name",nodesCol:"nodes",expandSpeed:"fast",expandTriggerFlag:false,root:{isRoot:true,nodes:[]},callback:{beforeClick:null,beforeChange:null,beforeDrag:null,beforeDrop:null,beforeRename:null,beforeRemove:null,beforeExpand:null,beforeCollapse:null,click:null,change:null,drag:null,drop:null,rename:null,remove:null,expand:null,collapse:null,asyncSuccess:null,
asyncError:null}};if(a){var e=a.checkType;a.checkType=undefined;var d=a.callback;a.callback=undefined;var g=a.root;a.root=undefined;f.extend(c,a);a.checkType=e;f.extend(true,c.checkType,e);a.callback=d;f.extend(c.callback,d);a.root=g;f.extend(c.root,g)}c.treeObjId=this.attr("id");c.treeObj=this;c.root.tId=-1;c.root.name="ZTREE ROOT";c.root.isRoot=true;c.checkRadioCheckedList=[];c.curTreeNode=null;c.curEditTreeNode=null;c.dragNodeShowBefore=false;c.dragStatus=0;c.expandTriggerFlag=false;c.root[c.nodesCol]||
(c.root[c.nodesCol]=[]);ca=0;if(b)c.root[c.nodesCol]=b;i[c.treeObjId]=c;f("#"+c.treeObjId).empty();Ga(c,this);if(c.root[c.nodesCol]&&c.root[c.nodesCol].length>0)H(c,0,c.root[c.nodesCol]);else c.async&&c.asyncUrl&&c.asyncUrl.length>0&&za(c);return(new Pa).init(this)};var T=[]})(jQuery);